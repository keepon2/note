# 目录

```sh
第五天 培训
1.web界面和功能全要知道
2.DHCP要知道具体每一步（网上资料很多）
3.明白前端接口如何到后端C回调函数
4.看SDK架构代码，对着资料库文档看
5.wifi（也是一种协议802.11）
6.手机(station)与路由器(AP)的接入过程（网上资料很多）
7.抓包（8种方式，后面全要知道）
8.bsp
```

### 前端接口是如何到后端C回调函数？
```sh
1.首先web界面点删除按钮删了一个表格，用F12的网络中捕获到了：url_filter_list_del.cgi

2.使用sourceinsight软件搜索url_filter_list_del.cgi
url_filter_list_del_cgi{
	里面找到igdCmConfDel函数
	ret = igdCmConfDel(IGD_SECUR_URL_FILTER_LIST_TAB,(unsigned char *)&data,sizeof(data));
}
igdCmConfDel函数是用来进行进程间通信（IPC）的，它将pucInfo指向的数据发送到另一个进程，并执行IPC_igdCmConfDel操作。
函数返回HI_IPC_CALL的执行结果。

全局搜IGD_SECUR_URL_FILTER_LIST_TAB找到一个IGDCM_OPER_REG函数（在gateway/cml/odl/source里面）

IGDCM_OPER_REG(IGD_SECUR_URL_FILTER_LIST_TAB, igdCmSecureUrlFilterListAdd, igdCmSecureUrlFilterListDel,
        igdCmSecureUrlFilterListSet, igdCmSecureUrlFilterListGet, igdCmSecureUrlFilterListEntryNumGet,
        igdCmSecureUrlFilterListGetallIndex, 0, 0, 0, 0);
在该文件中能找到对应的函数		
```

### DHCP工作流程

基于UDP，68（客户端）和67（服务器）端口  

|四个阶段|流程|
|---|---|
|发现阶段|客户端寻找服务器（广播）
|提供阶段|服务器（提供） -> IP地址
|选择阶段|客户端（选择） -> 服务器（提供）IP地址
|确认阶段|服务器（确认） -> 客户端

```sh
DHCP Message Type
1.Discover(客户端请求包)
2.Offer(服务器响应包)
3.Request(客户端选择包)
4.ACK(服务器确认包)
----------------------
5.Nak(服务器拒绝包)
6.Release(客户端释放包)
7.Decline
8.Inform
```

为什么DHCP能动态分配IP？  
DHCP服务器为客户端分配IP地址的优先次序如下:  
1.与客户端 MAC 地址或客户端 ID 静态绑定的 IP 地址;  
2.DHCP 服务器记录的曾经分配给客户端的 IP 地址;  
3.客户端发送的 DHCP-DISCOVER 报文中 Option 50 字段指定的 IP 地址;  
4.在 DHCP 地址池中，顺序査找可供分配的 IP 地址，最先找到的 IP 地址;  
5.如果未找到可用的 IP 地址，则依次査询租约过期、曾经发生过冲突的 IP 地址，
如果找到则进行分配，否则将不予处理。  






### 手机(station)与路由器(AP)的接入过程

打开设置界面 -> 选择账号 -> 输入密码 -> 连接成功

```sh
打开无线局域网开关：
        被动扫描：手机处于接收状态，接收AP发出的beacon帧
        主动扫描：手机在每个channel上都发送Probe request帧，请求对应的AP回应（可以广播）。AP接收到请求，会以Probe response作为回应。
点击某个AP连接：
        点击之后 -> 输入密码 -> 加入
        authentication(身份认证)和association(连接)
身份认证
        开放系统认证（无密码）
        共享密钥身份认证（有密码）
连接
```
